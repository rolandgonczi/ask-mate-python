<!doctype html>
<html>
<head>
    <title>AskMate | {{ question['title'] }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
</head>
<body>
    <a class="button" href="{{url_for('list_messages')}}">Back to list</a>
    <h1 class="question-title">{{ question['title'] }}</h1>
    {% if user_id == question['user_id'] %}
    <p>
        <a class="button edit" href="/question/{{ question['id'] }}/edit">üñãÔ∏è</a>
        <a class="button delete" href="/question/{{ question['id'] }}/delete">‚ùå</strong></a>
    </p>
    {% endif %}
    <div class="message question">
        <p>{{ question['message'] }}</p>
    </div>
    <div class="tags">
        <p>
            <ul>tags:
                {% for tag in question_tags %}
                    <li>{{ tag["name"] }}
                        <a href="{{url_for('delete_tag_from_question', question_id=question['id'], tag_id=tag['id'])}}" class="delete">
                            ‚ùå
                        </a>
                    </li>
                {% endfor %}
            </ul>
        </p>
    </div>
    {% if question['image'] %}
    <p><a target="_blank" rel="noopener noreferrer" href="{{ url_for('index') + 'images/' + question['image'] }}">
        <img src="{{ url_for('index') + 'images/' + question['image'] }}" height="128">
    </a></p>
    {% endif %}
    {% if user_id == question['user_id'] %}
    <p><a class="button" href="{{url_for('new_tag_for_question', question_id = question['id'])}}">Add tag</a></p>
    {% endif %}
    <table>
        <tr>
            <th>
                Question by:
            </th>
            <td>
                {{ question['username'] }}
            </td>
            <th>
                Submission Time:
            </th>
            <td>
                {{ question['submission_time'] }}
            </td>
            <th>
                View Number:
            </th>
            <td>
                {{ question['view_number'] }}
            </td>
            <th>
                Vote Number:
            </th>
            <td>
                {{ question['vote_number'] }}
            </td>
            <td>
                <table>
                    <tr>
                        <td>
                            <a href="/question/{{ question['id'] }}/vote-up/"><img
                                src="/ui/caret-arrow-up.png" width="16"></a>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <a href="/question/{{ question['id'] }}/vote-down/"><img
                                src="/ui/caret-arrow-down.png" width="16"></a>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    <p><a class="button" href="/question/{{ question['id'] }}/new-comment/">Add new comment</a></p>
    <div class="comment">
    {% if question_comments %}
        {% for comment in question_comments %}
            <ul>
                {% if user_id == comment['user_id'] %}
                <li><a class="button edit" href=" {{ url_for('edit_comment', comment_id=comment['id']) }}">üñãÔ∏è</a></li>
                <li><a class="button delete" href=" {{ url_for('delete_comment', comment_id=comment['id']) }}">‚ùå</a></li>
                {% endif %}
                <li><div class="message">{{ comment['message'] }}</div></li>
            </ul>
            <table>
                <tr>
                    <th>
                        Comment by:
                    </th>
                    <td>
                        {{ comment['username'] }}
                    </td>
                    <th>
                        Submission Time:
                    </th>
                    <td>
                        {{ comment['submission_time'] }}
                    </td>
                    <th>
                        Edited:
                    </th>
                    <td>
                        {{ comment['edited_count'] }} time{% if comment["edited_count"] != 1 %}s{% endif %}
                    </td>
                </tr>
            </table>
        {% endfor %}
    {% endif %}
    </div>
    <h2>Answers:</h2>
    {% if not user_id == question['user_id'] %}
    <p><a class="button" href="/question/{{ question['id'] }}/new-answer/">Add new answer</a></p>
    {% endif %}
    {% if answers %}
        {% for answer in answers %}
            {% if user_id == answer['user_id'] %}
            <p>
                <a class="button edit" href="/answer/{{ answer['id'] }}/edit">üñãÔ∏è</a>
                <a class="button delete" href="/answer/{{ answer['id'] }}/delete">‚ùå</a>
            </p>
            {% endif %}
            <div class="message answer">
                <p>{{ answer['message'] }}</p>
            </div>
            {% if answer['image'] %}
                <p><a target="_blank" rel="noopener noreferrer" href="{{ url_for('index') + 'images/' + answer['image'] }}">
                    <img src="{{ url_for('index') + 'images/' + answer['image'] }}" height="160">
                </a></p>
            {% endif %}
            <table>
                <tr>
                    <th>
                        Answer by:
                    </th>
                    <td>
                        {{ answer['username'] }}
                    </td>
                    <th>
                        Submission Time:
                    </th>
                    <td>
                        {{ answer['submission_time'] }}
                    </td>
                    <th>
                        Vote Number:
                    </th>
                    <td>
                        {{ answer['vote_number'] }}
                    </td>
                    <td>
                        <table>
                            <tr>
                                <td>
                                    <a href="/answer/{{ answer['id'] }}/vote-up/"><img
                                        src="/ui/caret-arrow-up.png" width="16"></a>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <a href="/answer/{{ answer['id'] }}/vote-down/"><img
                                        src="/ui/caret-arrow-down.png" width="16"></a>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
            <a class="button" href="{{ url_for('new_comment_to_specific_answer', answer_id=answer['id'])}}">Comment answer</a>
        <div class="comment">
            {% if answer_comments %}
                {% for comment in answer_comments %}
                    {% if comment['answer_id'] == answer['id'] %}
                        <ul>
                            {% if user_id == comment['user_id'] %}
                            <li><a class="button edit" href=" {{ url_for('edit_comment', comment_id=comment['id']) }}">üñãÔ∏è</a></li>
                            <li><a class="button delete" href=" {{ url_for('delete_comment', comment_id=comment['id']) }}">‚ùå</a></li>
                            {% endif %}
                            <li><div class="message">{{ comment['message'] }}</div></li>
                        </ul>
                        <table>
                            <tr>
                                <th>
                                    Comment by:
                                </th>
                                <td>
                                    {{ comment['username'] }}
                                </td>
                                <th>
                                    Submission Time:
                                </th>
                                <td>
                                    {{ comment['submission_time'] }}
                                </td>
                                <th>
                                    Edited:
                                </th>
                                <td>
                                    {{ comment['edited_count'] }} time{% if comment["edited_count"] != 1 %}s{% endif %}
                                </td>
                            </tr>
                        </table>
                    <p></p>
                    {% endif %}
                {% endfor %}
            {% endif %}
        </div>
        {% endfor %}
    {% else %}
        <p>No answers yet.</p>
    {% endif %}
    <br><br>
    <div>
        Icons made by
        <a href="https://www.flaticon.com/authors/dave-gandy" title="Dave Gandy">Dave Gandy</a>
        from
        <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a>
        is licensed by
        <a href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons BY 3.0" target="_blank">
        CC 3.0 BY</a>
    </div>
</body>
</html>